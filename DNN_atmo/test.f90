program test
    use dnn_atmo
    implicit none
    REAL(8),PARAMETER,dimension(5,30) :: Mcrit= reshape( &
                               [2.000110626220703125e+01_8, 1.419317871093750000e+03_8, 1.989919781684875488e+00_8,&
                                 1.086123335558750665e+27_8, 2.003540992736816406e+01_8,&
                                9.419130325317382812e+00_8, 1.058055419921875000e+03_8, 3.569471836090087891e+00_8,&
                                4.913673090865556694e+27_8, 2.170237731933593750e+01_8,&
                                2.000260114669799805e+00_8, 9.853795166015625000e+02_8, 9.765686392784118652e-01_8,&
                                9.559399402640994897e+26_8, 1.902515029907226562e+01_8,&
                                7.038930892944335938e+00_8, 1.393363525390625000e+03_8, 7.320392727851867676e-01_8,&
                                1.082499392773598636e+22_8, 6.981768131256103516e+00_8,&
                                3.454115390777587891e-01_8, 7.248211669921875000e+02_8, 1.077114120125770569e-01_8,&
                                6.051967353377975907e+22_8, 6.216354370117187500e+00_8,&
                                6.895268440246582031e+00_8, 1.121843017578125000e+03_8, 1.873725700378417969e+01_8,&
                                3.901043667746199647e+22_8, 5.631066799163818359e+00_8,&
                                2.530041337013244629e-01_8, 1.456052246093750000e+03_8, 7.180820941925048828e+00_8,&
                                2.458157775030313720e+26_8, 2.088248825073242188e+01_8,&
                                1.209571480751037598e+00_8, 5.982410888671875000e+02_8, 3.251705467700958252e-01_8,&
                                1.789970083417211221e+23_8, 5.681499958038330078e+00_8,&
                                1.140609550476074219e+01_8, 5.008962097167968750e+02_8, 2.177062034606933594e+00_8,&
                                1.956436542768834615e+25_8, 9.816193580627441406e+00_8,&
                                4.066470623016357422e+00_8, 1.536599121093750000e+02_8, 7.392477989196777344e-02_8,&
                                5.702425782547175157e+23_8, 4.805251121520996094e+00_8,&
                                1.292103826999664307e-01_8, 8.893193359375000000e+02_8, 1.526521146297454834e-01_8,&
                                3.076737893409565232e+22_8, 8.349666595458984375e+00_8,&
                                2.576397657394409180e-01_8, 7.823791503906250000e+02_8, 4.671779647469520569e-02_8,&
                                4.558170860948051888e+24_8, 1.218206119537353516e+01_8,&
                                2.781125605106353760e-01_8, 2.054942016601562500e+02_8, 2.040219783782958984e+00_8,&
                                1.438871257907258301e+24_8, 7.202479362487792969e+00_8,&
                                6.958132386207580566e-01_8, 8.350483398437500000e+02_8, 2.441643218994140625e+02_8,&
                                1.058169457795786482e+25_8, 9.702835083007812500e+00_8,&
                                1.336707323789596558e-01_8, 4.131788940429687500e+02_8, 1.746453344821929932e-02_8,&
                                1.147098789839980556e+26_8, 2.065169525146484375e+01_8,&
                                1.388001441955566406e+00_8, 2.772074279785156250e+02_8, 1.279826998710632324e+00_8,&
                                1.801326144064806550e+24_8, 6.426547050476074219e+00_8,&
                                3.361374139785766602e+00_8, 9.191636352539062500e+02_8, 9.569848632812500000e+01_8,&
                                1.887431894098477647e+27_8, 1.809850692749023438e+01_8,&
                                2.557881593704223633e+00_8, 6.022169799804687500e+02_8, 3.365765686035156250e+02_8,&
                                4.275878030545065406e+24_8, 7.364366531372070312e+00_8,&
                                1.165104484558105469e+01_8, 1.157872192382812500e+03_8, 1.855328321456909180e+00_8,&
                                2.565207401424187917e+24_8, 9.913743972778320312e+00_8,&
                                3.735550642013549805e+00_8, 9.072874755859375000e+02_8, 1.513735198974609375e+02_8,&
                                5.476468660026951304e+23_8, 6.313292026519775391e+00_8,&
                                5.377877712249755859e+00_8, 1.270259033203125000e+03_8, 8.075225830078125000e+00_8,&
                                1.188681809265818101e+26_8, 1.487959384918212891e+01_8,&
                                6.111573219299316406e+00_8, 1.868646850585937500e+02_8, 3.931260070800781250e+02_8,&
                                9.959370377616880039e+25_8, 9.720694541931152344e+00_8,&
                                3.265044987201690674e-01_8, 1.331355712890625000e+03_8, 6.935382080078125000e+01_8,&
                                4.456544750250073990e+25_8, 1.490277481079101562e+01_8,&
                                7.781746387481689453e-01_8, 8.369844360351562500e+02_8, 5.538549804687500000e+02_8,&
                                9.158863196368261203e+24_8, 9.187663078308105469e+00_8,&
                                4.874911308288574219e+00_8, 1.248269042968750000e+03_8, 1.071317520141601562e+02_8,&
                                9.620427134994929681e+26_8, 1.715409088134765625e+01_8,&
                                6.789798736572265625e-01_8, 1.016290039062500000e+03_8, 9.022710919380187988e-01_8,&
                                4.791835814246590963e+26_8, 1.880987548828125000e+01_8,&
                                2.579160690307617188e+00_8, 1.405478881835937500e+03_8, 8.699300765991210938e+00_8,&
                                7.045717075522768017e+27_8, 2.351701736450195312e+01_8,&
                                2.803879261016845703e+00_8, 4.809927978515625000e+02_8, 1.264693237304687500e+03_8,&
                                2.548912297108450893e+25_8, 9.080423355102539062e+00_8,&
                                2.443652302026748657e-01_8, 7.308287353515625000e+02_8, 1.260593652725219727e+00_8,&
                                1.173195168096756537e+25_8, 1.274620819091796875e+01_8,&
                                1.332685470581054688e+00_8, 1.443221679687500000e+03_8, 1.592465303838253021e-02_8,&
                                8.166445912667987442e+26_8, 2.317259788513183594e+01_8],[5,30])

REAL(8),PARAMETER,dimension(6,30) :: Menve= reshape([&
1.075572967529296875e+00_8, 4.538162231445312500e+01_8, 2.775793457031250000e+01_8,&
6.672101266331594520e+28_8, 5.968044757843017578e+00_8, 1.121955513954162598e+00_8,&
8.398272514343261719e+00_8, 1.188966308593750000e+03_8, 1.377182769775390625e+02_8,&
6.440363063461170760e+24_8, 6.535720825195312500e+00_8, 3.042790591716766357e-01_8,&
2.341119194030761719e+01_8, 1.399518676757812500e+03_8, 1.920926198363304138e-02_8,&
1.415156640465515666e+28_8, 7.901955604553222656e+00_8, 8.044534362852573395e-03_8,&
9.032628536224365234e-01_8, 1.215138305664062500e+03_8, 7.989444732666015625e+01_8,&
7.156270478791845615e+25_8, 8.569418907165527344e+00_8, 3.205807209014892578e-01_8,&
1.656331896781921387e+00_8, 2.664114379882812500e+02_8, 2.567451477050781250e+00_8,&
5.436138526164777543e+26_8, 1.426444625854492188e+01_8, 2.785554170608520508e+00_8,&
2.433078885078430176e-01_8, 1.239365722656250000e+03_8, 1.582629241943359375e+02_8,&
1.093815902809266397e+23_8, 6.562248229980468750e+00_8, 9.277517795562744141e-01_8,&
1.948873710632324219e+01_8, 1.133275146484375000e+03_8, 1.034631114453077316e-02_8,&
1.116461983319521294e+23_8, 8.187748908996582031e+00_8, 1.742250800132751465e+00_8,&
2.114916563034057617e+00_8, 8.699515991210937500e+02_8, 3.656032943725585938e+01_8,&
4.035469471500709813e+28_8, 7.441751956939697266e+00_8, 1.824771612882614136e-02_8,&
2.763456583023071289e+00_8, 7.522518920898437500e+02_8, 3.786657810211181641e+00_8,&
5.380274683113116642e+25_8, 1.029029750823974609e+01_8, 1.129702210426330566e+00_8,&
1.183355808258056641e+01_8, 3.639810485839843750e+02_8, 4.919978231191635132e-02_8,&
8.765673008164963248e+22_8, 3.771534204483032227e+00_8, 6.084656119346618652e-01_8,&
2.416934728622436523e+00_8, 7.615477905273437500e+02_8, 3.201420605182647705e-02_8,&
9.725911166389018269e+28_8, 2.909976482391357422e+00_8, 2.328357732039876282e-05_8,&
6.029574275016784668e-01_8, 9.752457275390625000e+02_8, 1.452572464942932129e+00_8,&
1.729272909511317908e+23_8, 7.287013053894042969e+00_8, 2.862987279891967773e+00_8,&
9.929178237915039062e+00_8, 1.312602050781250000e+03_8, 2.511273324489593506e-02_8,&
2.535124763399925827e+28_8, 6.447672843933105469e+00_8, 2.326568821445107460e-03_8,&
5.051050186157226562e-01_8, 4.610006408691406250e+02_8, 2.614177894592285156e+01_8,&
1.011013418118374700e+22_8, 1.803604006767272949e+00_8, 6.639584898948669434e-02_8,&
2.251019775867462158e-01_8, 1.095059082031250000e+03_8, 6.800832599401473999e-02_8,&
3.016568316200018374e+23_8, 8.032880783081054688e+00_8, 5.471181869506835938e-01_8,&
1.285419464111328125e-01_8, 2.467288970947265625e+02_8, 6.824420392513275146e-02_8,&
1.910239837366047159e+22_8, 4.267209053039550781e+00_8, 1.572790384292602539e+00_8,&
1.641988372802734375e+01_8, 6.104224014282226562e+01_8, 5.321455746889114380e-02_8,&
1.713848945478702415e+24_8, 5.285935878753662109e+00_8, 1.054064273834228516e+00_8,&
8.056535720825195312e-01_8, 3.809956054687500000e+02_8, 4.092687368392944336e-02_8,&
2.998617714025533057e+27_8, 1.832706260681152344e+01_8, 2.532937765121459961e+00_8,&
1.913616657257080078e-01_8, 1.126389648437500000e+03_8, 1.133995801210403442e-01_8,&
4.057755676613735493e+27_8, 2.020680999755859375e+01_8, 1.013189554214477539e+00_8,&
4.091105461120605469e+00_8, 1.189666870117187500e+03_8, 1.566344141960144043e+00_8,&
2.553360535751013178e+27_8, 1.364968585968017578e+01_8, 5.403121709823608398e-01_8,&
2.033811807632446289e+00_8, 5.604868774414062500e+02_8, 3.875034332275390625e+01_8,&
9.238448791370519546e+24_8, 4.193135261535644531e+00_8, 5.686454474925994873e-02_8,&
9.910000562667846680e-01_8, 1.385646209716796875e+02_8, 7.943703651428222656e+00_8,&
3.677104557778684687e+25_8, 2.247928619384765625e+00_8, 2.071185968816280365e-03_8,&
5.278306961059570312e+00_8, 4.875937500000000000e+02_8, 3.980660095214843750e+02_8,&
1.215366463414476717e+27_8, 1.353947448730468750e+01_8, 2.220525741577148438e+00_8,&
1.412160843610763550e-01_8, 5.319669723510742188e+01_8, 2.760415524244308472e-02_8,&
7.253506956153183403e+25_8, 1.735567092895507812e+01_8, 7.854328632354736328e+00_8,&
1.753226161003112793e+00_8, 2.489358215332031250e+02_8, 8.328010864257812500e+02_8,&
3.348710229870473212e+23_8, 2.457017660140991211e+00_8, 1.329822391271591187e-01_8,&
9.250291585922241211e-01_8, 6.681958007812500000e+02_8, 1.273869574069976807e-01_8,&
3.033840161202939510e+23_8, 5.604083061218261719e+00_8, 5.659165382385253906e-01_8,&
2.419421911239624023e+00_8, 5.872276000976562500e+02_8, 7.037370651960372925e-02_8,&
7.594061152935090816e+26_8, 2.119933843612670898e+00_8, 6.604311784030869603e-05_8,&
7.086993455886840820e-01_8, 5.155091552734375000e+02_8, 1.926272734999656677e-02_8,&
2.786988137851567504e+23_8, 1.369587063789367676e+00_8, 4.128601867705583572e-04_8,&
9.058976769447326660e-01_8, 9.442939453125000000e+02_8, 3.170230686664581299e-01_8,&
8.874637550247707970e+28_8, 1.509849739074707031e+01_8, 2.015033066272735596e-01_8,&
6.050094962120056152e-01_8, 6.828278808593750000e+02_8, 1.898557692766189575e-02_8,&
9.109080732940554296e+27_8, 7.644381046295166016e+00_8, 1.561929192394018173e-02_8],[6,30])

REAL(8),PARAMETER,dimension(6,30) :: Menve_cut= reshape([&
 -1.16280664e+00_8,  2.86180054e+00_8, -3.57918336e+00_8,  2.65455893e+01_8,&
   1.90331687e-01_8, 4.68980244e-08_8,&
 -4.46021409e-01_8,  3.16299993e+00_8, -1.28736027e+00_8,  2.76254652e+01_8,&
   1.61367992e-01_8, 4.21888293e-08_8,&
  4.29262298e-01_8,  2.86594263e+00_8,  1.73725224e+00_8,  2.83506558e+01_8,&
   9.61379306e-01_8, 5.08804928e-02_8,&
 -1.75431897e-02_8,  2.85343071e+00_8, -3.94037678e+00_8,  2.71591832e+01_8,&
   7.91886416e-01_8, 7.20918623e-03_8,&
  5.65241203e-01_8,  3.17069844e+00_8, -1.87588147e+00_8,  2.73888298e+01_8,&
   9.48288655e-01_8, 2.25415298e-02_8,&
 -1.12209905e+00_8,  2.77193547e+00_8, -2.99858831e+00_8,  2.83590461e+01_8,&
   1.15748491e+00_8, 2.90689051e-02_8,&
  7.96311525e-01_8,  3.10387600e+00_8, -4.66233510e+00_8,  2.78454260e+01_8,&
   1.08986135e+00_8, 5.12395403e-02_8,&
 -7.75906654e-01_8,  2.23321246e+00_8,  3.25263982e-01_8,  2.81799160e+01_8,&
   2.67167096e-01_8, 1.97443553e-05_8,&
 -7.38999579e-01_8,  3.09468680e+00_8,  1.39880420e+00_8,  2.56781022e+01_8,&
   2.11885257e-02_8, 1.87053385e-06_8,&
 -1.58485289e+00_8,  3.32116593e+00_8,  1.74093695e+00_8,  2.70300254e+01_8,&
   1.37103641e+00_8, 1.70232285e-03_8,&
 -1.12554267e+00_8,  2.81790346e+00_8, -2.81521997e-01_8,  2.59330719e+01_8,&
   7.70057283e-01_8, 1.07867936e-02_8,&
  4.60413520e-01_8,  3.08699927e+00_8,  7.89382985e-01_8,  2.82583154e+01_8,&
   5.05126121e-01_8, 1.75816189e-04_8,&
  6.93538017e-01_8,  3.36486058e+00_8, -6.09320392e-01_8,  2.59289762e+01_8,&
   7.03277927e-01_8, 1.56467811e-04_8,&
  1.08279655e-01_8,  2.79385461e+00_8, -8.94203542e-02_8,  2.66802192e+01_8,&
   8.66936168e-01_8, 8.90111106e-02_8,&
 -5.51831308e-01_8,  2.28172525e+00_8, -4.50911416e+00_8,  2.68178532e+01_8,&
   1.46126143e-01_8, 6.10695440e-06_8,&
  1.28192805e+00_8,  2.92983326e+00_8, -5.83285752e+00_8,  2.56365279e+01_8,&
     8.14175940e-01_8,3.10757568e-02_8,&
 -4.30722874e-01_8,  2.91193863e+00_8,  3.36663429e-02_8,  2.72238567e+01_8,&
    3.11747371e-01_8,3.06517647e-05_8,&
 -1.24734695e-01_8,  2.90703831e+00_8, -4.50121544e+00_8,  2.83922781e+01_8,&
    1.05755439e+00_8,3.29374336e-02_8,&
 -1.42437219e+00_8,  2.92801902e+00_8,  3.07465066e+00_8,  2.71798912e+01_8,&
    8.45019839e-01_8,1.26041948e-03_8,&
  2.90101157e-01_8,  3.18709359e+00_8, -2.11145042e+00_8,  2.74296754e+01_8,&
     8.47936710e-01_8,4.09628152e-03_8,&
 -1.59935336e+00_8,  3.11242533e+00_8, -4.55265880e+00_8,  2.73414325e+01_8,&
    1.43536220e+00_8,2.70802644e-04_8,&
 -2.58226226e-01_8,  3.09718240e+00_8, -1.50904373e+00_8,  2.65008164e+01_8,&
    8.18568754e-01_8,1.48033449e-02_8,&
 -6.41393345e-01_8,  2.37001893e+00_8, -1.94732900e+00_8,  2.60805940e+01_8,&
    7.01249067e-01_8,2.36924134e-02_8,&
 -1.52703107e+00_8,  3.15973979e+00_8,  5.68465684e-03_8,  2.56480929e+01_8,&
    7.95879605e-01_8,6.01637089e-06_8,&
  1.19676818e+00_8,  3.13865512e+00_8,  1.54497162e+00_8,  2.84613358e+01_8,&
     6.85587383e-01_8,1.72351981e-03_8,&
 -1.58485289e+00_8,  3.09999664e+00_8,  1.74093695e+00_8,  2.70300254e+01_8,&
    1.18889595e+00_8,1.15741984e-03_8,&
 -1.50243064e+00_8,  2.58463076e+00_8, -1.53774447e+00_8,  2.74599716e+01_8,&
    1.37038187e+00_8,3.70903925e-02_8,&
 -1.05365733e+00_8,  3.15402592e+00_8, -3.13145234e+00_8,  2.74788139e+01_8,&
    1.17476108e+00_8,4.58725234e-02_8,&
 -5.88836595e-01_8,  2.32239532e+00_8,  1.50597772e+00_8,  2.81755532e+01_8,&
    7.66524918e-01_8,8.49285335e-03_8,&
 -7.68521590e-01_8,  3.35175635e+00_8, -3.97001962e+00_8,  2.78390742e+01_8,&
    1.37052816e+00_8,7.91859472e-02_8],[6,30])

    INTEGER :: i
    REAL(8) :: prediction(30),t2,t1
    
    CALL INIT(dnn_path)
    
    call cpu_time(t1)
    do i = 1,30
        prediction(i) = mcrit_fit(Mcrit(1:4,i))
    enddo 
    call cpu_time(t2)
    do i = 1,30
        print*,Mcrit(5,i),prediction(i),(prediction(i)-Mcrit(5,i))*100._8/Mcrit(5,i)
    enddo
    print*,'Duration Total:    ',t2-t1
    print*,'Duration per call: ',(t2-t1)/30.0_8

    call cpu_time(t1)
    do i = 1,30
        prediction(i) = menve_fit(Menve(1:5,i))
    enddo 
    call cpu_time(t2)
    do i = 1,30
        print*,Menve(6,i),prediction(i),(prediction(i)-Menve(6,i))*100._8/Menve(6,i)
    enddo
    print*,'Duration Total:    ',t2-t1
    print*,'Duration per call: ',(t2-t1)/30.0_8

    call cpu_time(t1)
    do i = 1,30
        prediction(i) = menve_cut_fit(10._8**Menve_cut(1:5,i))
    enddo 
    call cpu_time(t2)
    do i = 1,30
        print*,Menve_cut(6,i),prediction(i),(prediction(i)-Menve_cut(6,i))*100._8/Menve_cut(6,i)
    enddo
    print*,'Duration Total:    ',t2-t1
    print*,'Duration per call: ',(t2-t1)/30.0_8

end program test
